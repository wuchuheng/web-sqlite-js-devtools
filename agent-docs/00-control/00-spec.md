<!--
TEMPLATE MAP (reference-only)
.claude/templates/docs/00-control/00-spec.md

OUTPUT MAP (write to)
agent-docs/00-control/00-spec.md

NOTES
- Keep headings unchanged.
- Keep this file concise and link to stage docs for detail.
-->

# 00 Project Spec

## 1) Project summary

- **One-sentence description**: A Chrome DevTools extension providing comprehensive SQLite database inspection, query execution, and safe migration/seed testing for web-sqlite-js directly within the browser DevTools panel.
- **Primary users**: Frontend developers, full-stack developers, and QA engineers working on offline-first PWAs and browser-based applications using web-sqlite-js.

## 2) Goals and success criteria

- **Goals**:
  - Enable real-time inspection and debugging of SQLite databases through `window.__web_sqlite` API
  - Provide safe testing environment for migration and seed SQL before production deployment
  - Visualize OPFS (Origin Private File System) file structure with download capabilities
  - Seamless integration with Chrome DevTools as a native panel
- **Success criteria**:
  - Extension icon activates only when `window.__web_sqlite` is detected on the active page
  - Users can browse table contents, execute queries, and view logs for any opened database
  - Migration and seed playgrounds allow safe testing with automatic rollback
  - OPFS file tree displays with lazy loading and download functionality
- **Non-goals**:
  - Modifying the web-sqlite-js library itself
  - Supporting non-Chrome browsers initially
  - Direct database file editing without SQL
  - Server-side database management
- **Source of truth**: `agent-docs/01-discovery/01-brief.md`, `agent-docs/01-discovery/02-requirements.md`, `agent-docs/01-discovery/03-scope.md`

## 3) Current stage

- **Current stage (1-8)**: Stage 8 - Worker (TASK-340)
- **Active release**: v1.4.0 (Popup Status Indicator) - Target: 2026-01-18
- **Status summary**: TASK-340 Complete (Popup Component Rewrite). TASK-339 Complete (Background Message Handler). TASK-338 Complete (Background Status Query Function). TASK-337 Complete (Message Type Definition). F-019 Task Catalog Complete. F-019 Design Complete. F-019 Discovery Complete. F-018 Task Catalog Complete (DevTools Real-time Communication). F-017 Complete (TASK-331). F-015 Complete (TASK-326/327/328/329). F-016 Complete (Logo Generator: TASK-330). F-014 Complete (TASK-320 through TASK-325). F-013 Complete, F-012 Complete, F-011 Complete, F-010 Complete, F-009 Complete, F-008 Complete.
- **Last updated (YYYY-MM-DD)**: 2026-01-18 (TASK-340: Popup Component Rewrite - Complete)

## 4) Technology stack (chosen in Stage 2)

- **Language/Runtime**: TypeScript
- **Backend Framework**: N/A (Chrome Extension)
- **Client/UI**: React 18 + Tailwind CSS 4 + react-router-dom (hash routing)
- **Database**: N/A (connects to existing web-sqlite-js v2.1.0+)
- **Cache**: N/A
- **Messaging**: Chrome Runtime API (content script proxy pattern) + Service Layer (Feature F-001)
- **Routing**: react-router-dom v6 with HashRouter
- **SQL Editor**: CodeMirror 6 (pending spike S-003 validation)
- **Icons**: react-icons
- **Auth**: N/A
- **Infrastructure**: Chrome Extension Manifest V3 + @crxjs/vite-plugin
- **CI/CD**: TBD
- **Observability**: N/A

## 5) Document index (reading order)

- `agent-docs/00-control/01-status.md`
- `agent-docs/01-discovery/01-brief.md`
- `agent-docs/01-discovery/02-requirements.md`
- `agent-docs/01-discovery/03-scope.md`
- `agent-docs/01-discovery/features/F-001-service-layer-expansion.md` (NEW - Feature F-001)
- `agent-docs/01-discovery/features/F-002-database-tab-navigation.md`
- `agent-docs/01-discovery/features/F-003-schema-panel-enhancement.md` (NEW - Feature F-003)
- `agent-docs/01-discovery/features/F-004-ddl-syntax-highlight-copy.md` (COMPLETED - Feature F-004)
- `agent-docs/01-discovery/features/F-005-opened-table-tabs-management.md` (NEW - Feature F-005)
- `agent-docs/01-discovery/features/F-006-resizable-vertical-dividers.md` (NEW - Feature F-006)
- `agent-docs/01-discovery/features/F-007-uniform-theme-configuration.md` (COMPLETED - Feature F-007)
- `agent-docs/01-discovery/features/F-008-opened-database-list-route.md` (NEW - Feature F-008)
- `agent-docs/01-discovery/features/F-009-log-tab.md` (COMPLETED - Feature F-009)
- `agent-docs/01-discovery/features/F-010-database-refresh-coordination.md` (NEW - Feature F-010)
- `agent-docs/01-discovery/features/F-011-eslint-integration.md` (NEW - Feature F-011)
- `agent-docs/01-discovery/features/F-012-opfs-browser-enhancement.md` (COMPLETED - Feature F-012)
- `agent-docs/01-discovery/features/F-013-opfs-two-panel-preview.md` (COMPLETED - Feature F-013)
- `agent-docs/01-discovery/features/F-014-opfs-ui-redesign.md` (NEW - Feature F-014)
- `agent-docs/01-discovery/features/F-015-opfs-tree-enhancements.md` (NEW - Feature F-015)
- `agent-docs/01-discovery/features/F-016-svg-to-png-logo-generator.md` (COMPLETED - Feature F-016)
- `agent-docs/01-discovery/features/F-017-realtime-database-status.md` (COMPLETED - Feature F-017)
- `agent-docs/01-discovery/features/F-018-devtools-realtime-communication.md` (NEW - Feature F-018)
- `agent-docs/01-discovery/features/F-019-popup-devtools-status.md` (NEW - Feature F-019)
- `agent-docs/02-feasibility/01-options.md`
- `agent-docs/02-feasibility/02-risk-assessment.md`
- `agent-docs/02-feasibility/03-spike-plan.md`
- `agent-docs/03-architecture/01-hld.md`
- `agent-docs/03-architecture/02-dataflow.md`
- `agent-docs/03-architecture/03-deployment.md`
- `agent-docs/04-adr/0001-content-script-proxy.md`
- `agent-docs/04-adr/0002-react-router-hash.md`
- `agent-docs/04-adr/0003-codemirror-sql-editor.md`
- `agent-docs/04-adr/0004-message-protocol.md`
- `agent-docs/04-adr/0005-log-ring-buffer.md`
- `agent-docs/04-adr/0006-auto-reconnect-strategy.md`
- `agent-docs/05-design/01-contracts/01-api.md` (UPDATED - Service Layer API)
- `agent-docs/05-design/01-contracts/02-events.md`
- `agent-docs/05-design/01-contracts/03-errors.md`
- `agent-docs/05-design/02-schema/01-message-types.md` (UPDATED - Service Layer Types)
- `agent-docs/05-design/03-modules/devtools-panel.md` (UPDATED - Service Layer Integration)
- `agent-docs/05-design/03-modules/database-service.md` (NEW - Feature F-001)
- `agent-docs/05-design/03-modules/content-script-proxy.md`
- `agent-docs/05-design/03-modules/background-service.md`
- `agent-docs/05-design/03-modules/opfs-browser.md`
- `agent-docs/05-design/03-modules/database-refresh.md` (NEW - Feature F-010)
- `agent-docs/07-taskManager/01-roadmap.md`
- `agent-docs/07-taskManager/02-task-catalog.md`
- `agent-docs/06-implementation/01-build-and-run.md` (pending)
- `agent-docs/06-implementation/02-test-plan.md` (pending)
- `agent-docs/06-implementation/03-observability.md` (pending)
- `agent-docs/06-implementation/04-release-and-rollback.md` (pending)
- `agent-docs/08-task/active/TASK-05.1.md` (NEW - TASK-05.1 Micro-Spec)
- `agent-docs/08-task/active/TASK-05.2.md` (NEW - TASK-05.2 Micro-Spec)

## 6) Recent changes

- **2026-01-13**: Stage 1 Discovery completed - brief, requirements, and scope documents created
- **2026-01-13**: Stage 2 Feasibility Analysis completed - Option A (Content Script Proxy) recommended, 4 spikes defined
- **2026-01-13**: Stage 3 Architecture completed - HLD, dataflow (8 flows), and deployment strategy documented
- **2026-01-13**: Stage 4 ADR completed - 6 ADRs created (Content Script Proxy, React Router, CodeMirror, Message Protocol, Log Ring Buffer, Auto-Reconnect)
- **2026-01-13**: Stage 5 Design completed - API contracts (10 channels), events (6 types), error standards, message types, and 4 module LLDs
- **2026-01-13**: Stage 7 Task Management completed - 6-phase roadmap (14 days) and 12 actionable tasks created
- **2026-01-13**: TASK-05 completed - Database List & Table Browser (inspectedWindow eval, sidebar DB list, table list)
- **2026-01-13**: Architecture refactor - replace channel messaging with inspectedWindow eval for DB access
- **2026-01-13**: Feature F-001 Architecture Update - Service Layer Expansion (3-layer pattern: Presentation → Service → Bridge)
  - Updated HLD to document 10 database service functions in centralized service layer
  - Separation of concerns: Components → databaseService.ts → inspectedWindowBridge → page context
  - All database operations now go through service layer for testability and maintainability
- **2026-01-13**: Feature F-001 Design Complete - Service Layer API and LLD Documentation
  - Updated `01-contracts/01-api.md` with complete service layer API (10 functions)
  - Created new `03-modules/database-service.md` with detailed service layer LLD
  - Updated `03-modules/devtools-panel.md` with service layer integration guide
  - Updated `02-schema/01-message-types.md` with ServiceResponse<T> types
  - Documented 3-layer architecture: Components → Service → Bridge → Page Context
  - Migration path defined for components to adopt service layer
- **2026-01-13**: TASK-05.1 completed - Service Layer Table Schema Functions
  - Added `ColumnInfo`, `TableSchema`, `QueryResult` types
  - Implemented `getTableSchema(dbname, tableName)` with PRAGMA table_info + DDL
  - Implemented `queryTableData(dbname, sql, limit, offset)` with pagination
  - Updated `databaseService` exports with new functions
- **2026-01-13**: TASK-05.2 completed - Service Layer SQL Execution Functions
  - Added `SqlValue`, `SQLParams`, `ExecResult` types
  - Implemented `execSQL(dbname, sql, params?)` with parameter support
  - Updated `DbQuery` type to include exec method
  - Updated `databaseService` exports with execSQL function
- **2026-01-13**: TASK-05.3 completed - Service Layer Log Streaming Functions
  - Added `LogEntry`, `LogSubscription`, `SubscribeResult` types (re-exported from DB types)
  - Implemented `subscribeLogs(dbname, callback)` with unique subscription ID generation
  - Implemented `unsubscribeLogs(subscriptionId)` with proper cleanup
  - Created `LogRingBuffer` module (500 entry circular buffer with batch sending)
  - Updated `databaseService` exports with subscribeLogs/unsubscribeLogs functions
  - Fixed TypeScript type issues for existing functions using DBInterface
- **2026-01-13**: TASK-05.4 completed - Service Layer Migration & Versioning Functions
  - Added `ReleaseConfig`, `DevReleaseResult`, `RollbackResult`, `DbVersionResult` types (re-exported from DB types)
  - Implemented `devRelease(dbname, version, migrationSQL?, seedSQL?)` using db.devTool.release()
  - Implemented `devRollback(dbname, toVersion)` using db.devTool.rollback()
  - Implemented `getDbVersion(dbname)` with PRAGMA user_version and fallback to DatabaseRecord maps
  - Updated `databaseService` exports with devRelease/devRollback/getDbVersion functions
- **2026-01-13**: TASK-05.5 completed - Service Layer OPFS File Browser Functions
  - Added `OpfsFileEntry`, `OpfsDownloadResult` types for OPFS file metadata
  - Implemented `formatFileSize` helper function for human-readable file sizes
  - Implemented `getOpfsFiles(path?, dbname?)` using navigator.storage.getDirectory()
  - Implemented `downloadOpfsFile(path)` with blob URL creation (caller responsible for cleanup)
  - Updated `databaseService` exports with getOpfsFiles/downloadOpfsFile functions
- **2026-01-14**: Feature F-004 completed - DDL Syntax Highlight & Copy Button
  - Implemented SQL syntax highlighting using `react-syntax-highlighter` with Prism.js light theme
  - Added copy button with clipboard API (`navigator.clipboard.writeText`)
  - Success feedback: green checkmark (`FaCheck`) persists until next click
  - Error handling: inline error message if clipboard API unavailable
  - Bundle impact: ~18.8KB for Prism.js variant, < 50KB total increase
- **2026-01-14**: Feature F-005 completed - Opened Table Tabs Management (TASK-301)
  - Created OpenedTableTabs component with memoized TabButton sub-component
  - Implemented state-managed opened tabs (show only opened tables, not all)
  - Close button with IoMdClose icon, visible on group-hover, hidden by default
  - Auto-switch to next tab after close (tries same index, falls back to last)
  - React Context for state sharing between TablesTab (parent) and TableDetail (child)
  - State owned by TablesTab, consumed via useOpenedTabs hook
  - Removed old TableTabButton component and tables.map() loop
  - Build passed with no errors (4.30s)
- **2026-01-14**: Feature F-006 completed - Resizable Vertical Dividers (TASK-302)
  - Created ResizeHandle component with draggable mouse events
  - Cursor change to `col-resize` on hover
  - Visual hover state: `hover:bg-blue-200 hover:w-2`
  - Visual dragging state: `w-2 bg-blue-300`
  - Left sidebar resize (min: 200px, max: 600px, default: 300px)
  - Right schema panel resize (min: 250px, max: 600px, default: 320px)
  - ARIA attributes: `role="separator"`, `aria-orientation="vertical"`, `aria-label="Resize panel"`
  - Build passed with no errors (4.00s)
- **2026-01-14**: TASK-303 completed - Integration Testing & Polish (F-005, F-006)
  - Fixed content area to use `flex-1` instead of `w-3/4` for proper resize behavior
  - Cross-feature testing: Resize works with opened tabs, schema toggle preserves width
  - Edge case testing: Min/max constraints enforced correctly
  - Marked F-005 and F-006 as completed in feature docs
  - Build passed with no errors (3.90s)
- **2026-01-14**: Feature F-011 completed - ESLint Integration (TASK-307)
  - Installed 8 ESLint packages (eslint, @eslint/js, @typescript-eslint/_, eslint-plugin-react_, eslint-plugin-prettier, globals)
  - Created `eslint.config.js` with flat config format (6 layers)
  - Configured TypeScript linting (no-undef off for TS files)
  - Configured React linting (React 17+ JSX, hooks rules)
  - Configured Prettier integration (eslint-plugin-prettier as last layer)
  - Configured Airbnb-style overrides (consistent-return, curly, console)
  - Updated `.vscode/settings.json` with eslint.enable: true
  - Added NPM scripts: lint, lint:fix
  - Initial lint run: 150 problems (108 errors, 42 warnings) - mostly unused vars, console statements, consistent-return issues
  - All build scripts verified working: typecheck, build, dev
  - Feature spec marked complete, status board updated
- **2026-01-15**: TASK-308 completed - Service Layer Delete Operations (F-012)
  - Added `deleteOpfsFile(path)` function for deleting files from OPFS
  - Added `deleteOpfsDirectory(path)` function for recursive directory deletion with item count
  - Updated `OpfsFileEntry` type with `fileType` and `itemCount` fields
  - Enhanced `getOpfsFiles()` to fetch file type (SQLite Database, JSON Data, etc.) and directory item counts
  - Added `detectFileType()` helper function for file type detection based on extension
  - Exported new functions via `databaseService` object
  - TypeScript compliance: Fixed `FileSystemDirectoryHandle.values()` type errors with `eslint-disable-next-line` comments
- **2026-01-15**: TASK-309 completed - Guided Tree Lines Component (F-012)
  - Added `TreeLines.tsx` component for VSCode-style tree hierarchy
  - Implemented vertical line connector (1px gray-200, absolute positioned div)
  - Implemented horizontal line connector (12px gray-200, absolute positioned div)
  - Implemented last child adjustment (L-shaped connector with 50% height vertical)
  - Added responsive hiding with ResizeObserver (hide lines when sidebar < 200px)
  - Integrated with FileTree.tsx (wrap children with TreeLines, pass depth/showLines/isLast props)
  - Added horizontal connector to each non-root item in FileTreeItem
  - Accessibility: `aria-hidden="true"` on decorative line elements
  - Type check passed with no new errors
- **2026-01-15**: TASK-310 completed - Delete Confirmation Modal (F-012)
  - Created `DeleteConfirmModal.tsx` component for file and directory deletion confirmation
  - Implemented modal structure with backdrop overlay and centered container
  - Added metadata display grid (type badge, size, file type, modified date, item count, full path)
  - Implemented conditional rendering for files vs directories (size/fileType vs itemCount)
  - Added warning text with enhanced directory warning showing total items count
  - Implemented Escape key handler and backdrop click handler for closing modal
  - Added confirm (red with trash icon) and cancel (gray) buttons
  - Implemented loading state with spinner during deletion operation
  - Disabled close actions during deletion (isDeleting state)
  - Accessibility: `role="dialog"`, `aria-modal="true"`, `aria-labelledby="delete-modal-title"`
  - Type check passed with no new errors
- **2026-01-15**: TASK-311 completed - Enhanced Metadata Display (F-012)
  - Created `fileTypeDetection.ts` utility module (detectFileType, getBadgeColor, getBadgeColorClasses)
  - Implemented 30+ file type mappings (SQLite, JSON, XML, CSV, Text, Markdown, Log, Image, SVG, Audio, Video)
  - Added color-coded badges (blue for databases, yellow for data, gray for text, purple for images, green for audio, red for video)
  - Created `timestampFormatting.ts` utility module (formatTimestamp, getRelativeTime)
  - Implemented YYYY-MM-DD HH:mm timestamp formatting with local time
  - Implemented relative time strings ("just now", "2 minutes ago", "3 hours ago", "4 days ago")
  - Created `MetadataPanel.tsx` component with inline/expanded view modes
  - Inline view: compact metadata row with type badge and timestamp (150ms fade-in on hover)
  - Expanded view: detailed list with type, modified date, item count, full path
  - Updated `FileNode.tsx` to integrate MetadataPanel with hover state
  - Type check passed with no new errors
- **2026-01-15**: TASK-312 completed - Toast Notifications (F-012)
  - Created `Toast.tsx` component with success and error variants
  - Success variant: green styling with FaCheck icon, 3 second auto-dismiss
  - Error variant: red styling with FaExclamationCircle icon, 5 second auto-dismiss, retry button
  - Implemented auto-dismiss logic with useEffect and setTimeout
  - Added proper cleanup for timeout on unmount/visibility change
  - Implemented close button with X icon
  - Added slide-in animation using Tailwind arbitrary values (animate-[slide-in_0.3s_ease-out])
  - Fixed positioning at top-right with z-index 60 (above modal)
  - Accessibility: role="alert", aria-live="polite", aria-atomic="true", aria-label on close button
  - Type check passed with no new errors
- **2026-01-15**: TASK-313 completed - Integration & Testing (F-012)
  - Updated \`FileTree.tsx\` with onDelete callback support
  - Added action buttons (download and delete) with hover state (opacity-0 group-hover:opacity-100)
  - Added isDownloading state and handleDownload/handleDelete callbacks
  - Updated \`FileNode.tsx\` with delete button (IoMdTrash icon, ARIA label)
  - Updated \`OPFSGallery.tsx\` with DeleteConfirmModal and Toast integration
  - Added modal state management (isModalOpen, selectedEntry, isDeleting)
  - Added toast state management (isVisible, variant, title, message, itemName)
  - Added handleDeleteClick to open modal, handleDeleteConfirm to execute deletion
  - Added handleModalClose, handleToastDismiss, and handleToastRetry callbacks
  - Integrated DeleteConfirmModal and Toast components into JSX
  - Error handling with success/error toast notifications
  - Type check passed with no new errors
  - **F-012 Feature Complete**: All 6 tasks finished (TASK-308 through TASK-313)
- **2026-01-15**: F-013 Discovery completed - OPFS Browser Two-Panel Layout with File Preview
  - Analyzed target UI design from screenshot (green header, two-panel layout, file preview)
  - Identified gap between current single-panel OPFS browser and target two-panel design
  - Interviewed user for requirements clarification (preview panel, emerald theme, text/image files, preserve F-012 features)
  - Created feature specification document with 12 sections
  - Documented 14 functional requirements (FR-OPFS-001 through FR-OPFS-014)
  - Documented 5 non-functional requirements (NFR-OPFS-001 through NFR-OPFS-005)
  - Defined component structure (FilePreview, TextPreview, ImagePreview, EmptyPreview, UnsupportedPreview)
- **2026-01-15**: F-013 Full Documentation Chain Completed (S2 → S3 → S5 → S7)
  - **Stage 2 (Feasibility Analysis)**: Evaluated 3 technical options, recommended Option A (Split-Panel Layout)
    - Risk assessment: LOW risk (proven patterns from F-006, F-012)
    - Technical approach: Two-panel layout with resizable divider, file content loading via OPFS API
    - Performance targets: Text < 1s (< 1MB), Images < 2s (< 5MB), Panel resize 60fps
    - Browser compatibility: Chrome 111+, Edge 111+, Firefox not supported
  - **Stage 3 (Architecture)**: Added Section 18 to HLD - OPFS Browser Two-Panel Layout Architecture
    - C4 Component diagram for two-panel layout
    - Component hierarchy (OPFSGallery, FileTree, FilePreview, TextPreview, ImagePreview, etc.)
    - Data flow for file content loading (FileTree → FilePreview → databaseService → OPFS)
    - Panel resizing architecture (ResizeHandle integration, state management)
    - File content loading service (getFileContent function signature and implementation)
    - Preview component architecture (FilePreview, TextPreview, ImagePreview, EmptyPreview, UnsupportedPreview)
    - Integration with existing F-012 components (preserved all features)
    - File structure, accessibility, performance considerations, error handling, edge cases
  - **Stage 5 (Design)**: Updated API Contract and Module LLD
    - **API Contract (01-api.md)**: Added `getFileContent(path)` function to OPFS File Browser section
      - Function signature with ServiceResponse wrapper
      - Response examples for text, image, and binary files
      - Business logic: file type detection, content reading, metadata, size limits
      - Error cases: file not found, permission denied, file too large, encoding errors
    - **Module LLD (opfs-browser.md)**: Added Section 11 - Two-Panel Layout with File Preview
      - File Tree Update (OPFSGallery, FileTree, FileNode modifications)
      - FilePreview Component (main container with state management)
      - TextPreview Component (monospace font, emerald header, metadata display)
      - ImagePreview Component (responsive scaling, object URL cleanup)
      - EmptyPreview Component (no selection state with helpful icon)
      - UnsupportedPreview Component (binary files with download button)
      - File Content Loading Flow (sequence diagram)
      - State Management (OPFSGallery and FilePreview states)
      - UI/UX Patterns (two-panel layout, selected file highlight, loading/error states)
      - Accessibility (file selection, preview panel, divider)
      - Performance considerations (file size limits, optimization strategies)
      - Browser compatibility (OPFS API, File.text(), Blob API, CSS object-fit)
      - Error handling (error types, recovery mechanisms)
      - Edge cases (large files, SQLite databases, binary files, encoding errors)
      - Integration with F-012 components (all features preserved)
  - **Stage 7 (Task Management)**: Updated Roadmap and Task Catalog
    - **Roadmap (01-roadmap.md)**: Added Phase 10 - OPFS Browser Two-Panel Layout (Days 18-20)
      - Feature overview, target date (2026-01-17), dependencies (F-012 must be complete)
      - 6 tasks breakdown: TASK-314 through TASK-319
      - Success criteria (11 items: two-panel layout, resizable divider, file selection, previews, states, F-012 preservation)
      - Risk mitigation (medium complexity, 4 files modified, 5 new components, no breaking changes)
      - Timeline (Day 1: 2h, Day 2: 3h, Day 3: 4h, Total: 9h)
      - Definition of Done (15 items: all tasks complete, all features working, testing, documentation)
    - **Task Catalog (02-task-catalog.md)**: Added 6 tasks to v1.2.0 release
      - TASK-314: Service Layer - File Content Loading (2h) - Add getFileContent function, file type detection, size limits
      - TASK-315: File Preview Component Structure (2h) - Main container, state management, conditional rendering
      - TASK-316: Text Preview Implementation (1.5h) - Monospace font, emerald header, line breaks preserved
      - TASK-317: Image Preview Implementation (1.5h) - Responsive scaling, object URL cleanup, aspect ratio
      - TASK-318: Panel Resizing Integration (2h) - Two-panel layout, ResizeHandle integration, selected state
      - TASK-319: Integration & Testing (2h) - EmptyPreview/UnsupportedPreview, integration testing, documentation
      - Total estimated: 9 hours (within 8-12 hour estimate from feasibility analysis)
    - **Micro-Specs**: Created 6 task micro-specs in `agent-docs/08-task/active/`
      - TASK-314.md: Service Layer - File Content Loading (detailed DoD, testing checklist)
      - TASK-315.md: File Preview Component Structure (state management, conditional rendering)
      - TASK-316.md: Text Preview Implementation (monospace font, metadata display, large file handling)
      - TASK-317.md: Image Preview Implementation (responsive scaling, object URL cleanup)
      - TASK-318.md: Panel Resizing Integration (two-panel layout, ResizeHandle, selected state)
      - TASK-319.md: Integration & Testing (EmptyPreview/UnsupportedPreview, 10+ test scenarios)
  - **Ready for Stage 8**: All documentation complete, ready for implementation by S8:worker
  - **Estimated Implementation Time**: 9 hours (6 tasks: service layer, preview components, panel resizing, integration)
  - **Technical Approach**: Split-panel layout with resizable divider, file content loading via OPFS API, text/image preview components
  - **Risk Level**: LOW (proven patterns from F-006, F-012, 90% code reusability)
  - Identified dependencies on F-012 (must be complete) and F-006 (ResizeHandle reuse)
  - Estimated timeline: 8-12 hours total (Discovery: 1h, Feasibility: 1h, Architecture: 2h, Design: 2h, Implementation: 4-6h, Testing: 1h)
  - Next stages: Feasibility Analysis (S2:feasibilityAnalyst) → Architecture (S3:systemArchitect) → Design (S5:contractDesigner) → Task Management (S7:taskManager)
- **2026-01-17**: Feature F-016 Discovery Completed - SVG to PNG Logo Generator
  - Created feature spec document with 8 PNG generation requirements (4 sizes × 2 states)
  - Documented NPM script integration: `npm run generate:logos`
  - Specified TypeScript + tsx runtime approach (no additional image libraries)
  - Added to v1.3.1 release roadmap as Phase 13 (TASK-330/331)
  - Updated project spec and documentation index with F-016 reference
  - Ready for Stage 8 (S8:worker) implementation
- **2026-01-17**: TASK-331 completed - SVG to PNG Logo Generator Implementation (F-016)
  - **Implementation**: Rewrote `scripts/generate-logos.tsx` (295 lines) using SVG filter approach
    - Added `addGrayscaleFilter()` function: Injects `<feColorMatrix type="saturate" values="0"/>` into SVG `<defs>`
    - Added `applyGrayscaleFilter()` function: Applies `filter="url(#grayscale)"` to SVG root element
    - Added `addGrayBackground()` function: Adds gray rectangle `<rect fill="#808080"/>` as first child
    - Added `createInactiveSVG()` function: Orchestrates 3-step transformation (filter → apply → background)
  - **SVG Filter Benefits**: Native W3C standard, 50 lines vs 200+ for manual color manipulation, hardware-accelerated rendering, works with ANY SVG structure
  - **PNG Generation**: All 8 files generated successfully (16/32/48/128px × active/inactive states)
    - logo-16.png (538 bytes), logo-16-inactive.png (507 bytes)
    - logo-32.png (978 bytes), logo-32-inactive.png (939 bytes)
    - logo-48.png (1452 bytes), logo-48-inactive.png (1361 bytes)
    - logo-128.png (3854 bytes), logo-128-inactive.png (3753 bytes)
  - **Code Quality**: Three-phase comments (Input → Process → Output), TSDoc documentation, functional design (pure functions, no classes), proper error handling
  - **Build Status**: ESLint passed with no errors
  - **Documentation**: Created SVG filter research docs (SVG_FILTER_RESEARCH.md, SVG_COLOR_CONVERSION_RULES.md), updated feature spec as complete
  - **Feature F-016 Complete**: Developer tooling for logo generation ready for use
- **2026-01-17**: Feature F-018 Discovery Completed - DevTools Real-time Communication
  - Created feature spec document with 4 functional requirements (FR-RT-001 through FR-RT-004)
  - Analyzed web-sqlite-js API (`dev-tool-README.md`) for `db.onLog()` and `onDatabaseChange` events
  - Identified message flow: Content Script → Relay → Background → DevTools Panel
  - Documented log entry enrichment pattern: `{ database: string, level: string, message: any }`
  - Specified auto-refresh database list on `/openedDB` route (no polling, event-driven)
  - Specified real-time log streaming with database filtering for `/openedDB/:dbname/logs` route
  - Added to v1.3.1 release as Feature F-018
  - Updated project spec with F-018 reference
  - Ready for Stage 2 (S2:feasibilityAnalyst) feasibility analysis
- **2026-01-17**: Feature F-018 Feasibility Completed - DevTools Real-time Communication
  - Analyzed 3 technical options: chrome.runtime.sendMessage (A), chrome.runtime.Port (B), Polling (C)
  - **Recommended**: Option A (chrome.runtime.sendMessage extension) - 4-6 hours effort
  - Reuses 100% of existing CrossWorldChannel infrastructure from F-017
  - Zero new infrastructure: fire-and-forget semantics match log streaming use case
  - Tradeoff analysis: Option A fastest (4-6h), lowest complexity, meets all NFR targets
  - Risk assessment: 8 risks identified (R-RT-001 through R-RT-008), all mitigated
  - Spike plan: 3 spikes defined (S-RT-001, S-RT-002, S-RT-003) - 1.5 hours total
  - Key decision: Best-effort delivery acceptable for logs; databaseMap provides source of truth
  - Updated project spec: Stage 2 status, feasibility documents ready
  - Ready for Stage 3 (S3:systemArchitect) architecture updates
- **2026-01-17**: Feature F-018 Architecture Completed - DevTools Real-time Communication
  - Updated HLD (01-hld.md) message protocol section with DevTools panel as message recipient
  - Updated code structure: Added useDatabaseList.ts and useLogStreaming.ts hooks
  - Updated contentScript section to include log subscription manager functionality
  - Updated shared section with CrossWorldChannel and WebSqliteMonitor utilities
  - Updated background worker section to include message forwarding to DevTools
  - Updated dataflow (02-dataflow.md) with 2 new flows (Flow 9, Flow 10)
  - Flow 9: Database List Update to DevTools Panel - shows auto-refresh on database open/close
  - Flow 10: Log Streaming to DevTools Panel - shows real-time log streaming with database identification
  - Updated event flows: Database Changed now includes DevTools panel as consumer
  - Updated event flows: Log Entry now shows enriched format { database, level, message }
  - Updated project spec: Stage 3 status, architecture documents ready
  - Ready for Stage 4 (S4:adrSteward) or Stage 5 (S5:contractDesigner) for design updates
- **2026-01-17**: Feature F-018 Design Completed - DevTools Real-time Communication
  - Updated API contracts (01-api.md) with DevTools Panel Real-time Messaging section
  - Added DATABASE_LIST_MESSAGE channel for auto-refresh database list updates
  - Added LOG_ENTRY_MESSAGE channel for real-time log streaming with database identification
  - Message flow diagram: Content Script → CrossWorldChannel → Relay → Background → DevTools Panel
  - Updated events (02-events.md) with enriched LOG_ENTRY event format { database, level, message }
  - Updated message types (01-message-types.md) with new F-018 types:
    - DatabaseListMessage, LogEntryMessage, DatabaseListUpdateEvent, LogEntryUpdateEvent
  - Updated LogTabState with database filtering: filter.database field
  - Updated LogEntry interface with database field and renamed 'data' to 'message'
  - Updated module LLDs:
    - content-script-proxy.md: Added log subscription responsibilities and enriched relay implementation
    - background-service.md: Added DevTools panel message forwarding flow and functions
  - Updated project spec: Stage 5 status, design documents ready
  - Ready for Stage 7 (S7:taskManager) for task breakdown and implementation
